<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<!-- Actions -->

		<record id="action_practices_from_partner" model="ir.actions.act_window">
			<field name="name">Practices</field>
			<field name="res_model">podiatry.practice</field>
			<field name="context">{'default_partner_id': active_id}</field>
			<field name="domain">[('partner_id', '=', active_id)]</field>
		</record>

		<record id="action_practitioners_from_partner" model="ir.actions.act_window">
			<field name="name">Practitioners</field>
			<field name="res_model">podiatry.practitioner</field>
			<field name="context">{'default_partner_id': active_id}</field>
			<field name="domain">[('partner_id', '=', active_id)]</field>
		</record>

		<record id="action_patients_from_partner" model="ir.actions.act_window">
			<field name="name">Patients</field>
			<field name="res_model">podiatry.patient</field>
			<field name="context">{'default_partner_id': active_id}</field>
			<field name="domain">[('partner_id', '=', active_id)]</field>
		</record>

		<record model="ir.ui.view" id="partner_view_form_inherit">
			<field name="name">partner.view.user</field>
			<field name="model">res.partner</field>
			<field name="inherit_id" ref="base.view_partner_form" />
			<field name="arch" type="xml">
				<xpath expr="//field[@name='company_type']" position="after">
					<group colspan="6" col="6">
						<field name="is_practice" />
						<field name="is_practitioner" />
						<field name="is_patient" />
					</group>
				</xpath>
				<xpath expr="//group" position="inside">
					<!-- <group>
						<field name="dob" string="Dob"></field>
						<field name="age" string="Age"></field>
					</group> -->
				</xpath>
				<xpath expr="//div[hasclass('oe_button_box')]" position="inside">
					<field name="practice_ids" invisible="1"/>
					<button type="action" name="%(action_practices_from_partner)d" class="oe_stat_button" icon="fa-building-o" attrs="{'invisible' : [('practice_ids', '=', [])]}">
						<field name="practice_count" string="Practices" widget="statinfo"/>
					</button>
					<field name="practitioner_id" invisible="1"/>
					<button type="action" name="%(action_practitioners_from_partner)d" class="oe_stat_button" icon="fa-user" attrs="{'invisible' : [('practitioner_id', '=', [])]}">
						<field name="practitioner_count" string="Practitioners" widget="statinfo"/>
					</button>
					<field name="patient_ids" invisible="1"/>
					<button type="action" name="%(action_patients_from_partner)d" class="oe_stat_button" icon="fa-user" attrs="{'invisible' : [('patient_ids', '=', [])]}">
						<field name="patient_count" string="Patients" widget="statinfo"/>
					</button>
					<button name="open_customer_prescriptions" class="oe_stat_button" type="object" icon="fa-tasks">
						<field string="Prescription" name="prescription_count" widget="statinfo"/>
					</button>
				</xpath>
			</field>
		</record>

	    <!-- Search -->
		<record id="partner_view_search_inherit" model="ir.ui.view">
			<field name="name">partner.search.user</field>
			<field name="model">res.partner</field>
			<field name="inherit_id" ref="base.view_res_partner_filter"/>
			<!-- <field name="groups_id" eval="[(4, ref('group_user'))]"/> -->
			<field name="arch" type="xml">
				<xpath expr="//filter[@name='inactive']" position="before">
					<filter string="Practices" name="is_practice" domain="[('is_practice', '=', True)]" />
					<separator/>
					<filter string="Practitioners" name="is_practitioner" domain="[('is_practitioner', '=', True)]" />
					<separator/>
					<filter string="Patients" name="is_patient" domain="[('is_patient', '=', True)]" />
					<separator/>
				</xpath>
			</field>
		</record>
	

	    <!-- Action > TODO: Add integration with the Contacts module -->
		<record id="action_res_partner_practices" model="ir.actions.act_window">
			<field name="name">Practices</field>
			<field name="res_model">res.partner</field>
			<field name="context">{'search_default_is_practice': True}</field>
		</record>

		<record id="action_res_partner_practitioner" model="ir.actions.act_window">
			<field name="name">Practitioners</field>
			<field name="res_model">res.partner</field>
			<field name="context">{'search_default_is_practitioner': True}</field>
		</record>

		<record id="action_res_partner_patients" model="ir.actions.act_window">
			<field name="name">Patients</field>
			<field name="res_model">res.partner</field>
			<field name="context">{'search_default_is_patient': True}</field>
		</record>


	</data>
</odoo>
