<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="portal_layout_prescription_custom" name="Portal layout: Blanket Sales Order" inherit_id="portal.portal_breadcrumbs" priority="50">
        <xpath expr="//ol[hasclass('o_portal_submenu')]" position="inside">
            <li t-if="page_name == 'prescription_page_custom' or prescription_custom_id" t-attf-class="breadcrumb-item #{'active' if not prescription_page_custom else ''}">
                <a t-if="prescription_custom_id" t-attf-href="/web/portal/prescription_view?{{ keep_query() }}">Blanket Sales Order</a>
                <t t-else="">Blanket Sales Order</t>
            </li>
            <li t-if="prescription_custom_id" class="breadcrumb-item active text-truncate">
              <span t-field="prescription_custom_id.name"/>
            </li>
        </xpath>
    </template>

    <template id="portal_my_home_prescription_custom" name="Show Blanket Sales Order" customize_show="True"  inherit_id="portal.portal_my_home" priority="50">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <t t-call="portal.portal_docs_entry">
              <t t-set="title">Blanket Sales Order</t>
              <t t-set="url" t-value="'/web/portal/prescription_view'"/>
              <t t-set="placeholder_count" t-value="'prescription_count_custom'"/> 
            </t>
        </xpath>
    </template>

    <template id="custom_prescription_details_page" name="Blanket Sales Order Details">
      <t t-call="portal.portal_layout">
        <t t-set="breadcrumbs_searchbar" t-value="True"/>
        <t t-call="portal.portal_searchbar">
          <t t-set="title">Blanket Sales Order</t>
        </t> 
        <t t-if="not total_bso_custom">
          <div class="alert alert-warning mt8" role="alert">
              There are no prescriptions order.
          </div>
        </t> 
        <t t-if="total_bso_custom" t-call="portal.portal_table">
          <thead style="font-size: 0.8rem">
            <tr>
              <th>Name</th>
              <th>Order Date</th>
              <th>Validity Start Date</th>
              <th>Validity End Date</th>
              <th>Sales Representative</th>
              <th>Status</th>
              
            </tr>
          </thead>
          <tbody style="font-size: 0.8rem">
            <t t-foreach="total_bso_custom" t-as="bso">
              <tr>
                <td><a t-attf-href="/web/portal/prescription/view/#{bso.id}?{{ keep_query() }}">
                  <span t-esc="bso.name"/>
                </a></td>
                <td><span t-field="bso.date_order"/></td>
                <td><span t-field="bso.validity_start_date"/></td>
                <td><span t-field="bso.validity_end_date"/></td>
                <td><span t-field="bso.user_id"/></td>
                <td><span t-field="bso.state"/></td>
              </tr>
            </t>
          </tbody>
        </t>
      </t>
    </template>

    <template id="portal_prescription_custom_form" name="Balnket Sales Order">
      <t t-call="portal.portal_layout">
        <t t-call="portal.portal_record_layout">
          <t t-set="card_header">
              <div class="row no-gutters">
                  <div class="col-12">
                      <h5 class="d-flex mb-1 mb-md-0 row">
                          <div class="col-9">
                            <span t-field="prescription_custom_id.name" class="text-truncate"/>
                          </div>
                          <div class="col-3 text-right">
                            <small class="text-right">Status : </small>
                            <!-- <span t-field="prescription_custom_id.state" class=" badge badge-pill badge-info" title="Current status of this prescription order"/> -->
                            <span t-field="prescription_custom_id.state" class=" badge rounded-pill text-bg-info" title="Current status of this prescription order"/>
                          </div>
                      </h5>
                  </div>
                  
              </div>
          </t> 
          <t t-set="card_body">
            <div class="row mt-6">
              <div class="col-12 col-md-6 pb-2">
                <div class="mb-3"><strong>Customer : </strong> 
                  <span t-field="prescription_custom_id.partner_id"/>
                </div>
                <div class="mb-3"><strong>Order Date : </strong> 
                  <span t-field="prescription_custom_id.date_order"/>
                </div>
                <div class="mb-3"><strong>Validity Start Date : </strong>
                  <span t-field="prescription_custom_id.validity_start_date"/>
                </div>
              </div>
              <div class="col-12 col-md-6 pb-2">
                  <div class="mb-3"><strong>Sales Representative : </strong>
                    <span t-field="prescription_custom_id.user_id"/>
                  </div>
                  <div class="mb-3"><strong>Company : </strong>
                    <span t-field="prescription_custom_id.company_id"/>
                  </div>
                  <div class="mb-3"><strong>Validity End Date : </strong>
                    <span t-field="prescription_custom_id.validity_end_date"/>
                  </div>
              </div>
            </div>
            <br/><br/>
            <t t-if="prescription_custom_id.order_line">
              <div class="row">
                <div class="row ml-3 mb-2"><h3> Order Lines : </h3></div>
              </div>
                <table class="table table-sm">
                  <thead class="bg-100">
                    <tr>
                      <td><strong>Product </strong ></td>
                      <td><strong>Description </strong ></td>
                      <td><strong>Quantity</strong></td>
                      <td><strong>Product Unit of Measure</strong></td>
                      <td><strong>Unit Price</strong></td>
                    </tr>
                  </thead>
                  <tbody>
                    <t t-foreach ="prescription_custom_id.order_line" t-as="line">
                      <tr>
                        <td><span t-field="line.product_id"/></td>
                        <td><span t-field="line.name"/></td>
                        <!-- <td><span t-field="line.product_qty"/></td> -->
                        <td><span t-field ="line.product_uom_qty"/></td>
                        <!-- <td><span t-field="line.product_uom_id"/></td> -->
                        <td><span t-field="line.product_uom"/></td> 
                        <td><span t-field="line.price_unit" t-options='{"widget": "monetary", "display_currency": prescription_custom_id.currency_id}'/></td>
                      </tr>
                    </t>
                  </tbody>
                </table>
            </t>
          </t>
        </t>
      </t>
    </template>
</odoo>