<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>

        <record id="sale_order_quote_view_form" model="ir.ui.view">
            <field name="name">sale.order.quote.form</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale_management.sale_order_form_quote"/>
            <field name="arch" type="xml">
                <field name="partner_id" position="after">
                    <field name="is_clinic" invisible="1"/>
                </field>
                <xpath expr="//field[@name='sale_order_template_id']" position="after">
                    <field name="clinic_id" attrs="{'invisible': [('is_clinic','!=', True)]}" />
                </xpath>
            </field>
        </record>

        <record id="sale_order_quote_search_view_form" model="ir.ui.view">
            <field name="name">sale.order.quote.search.form</field>
            <field name="model">sale.order</field>
            <field name="mode">primary</field>
            <field name="inherit_id" ref="sale.view_sales_order_filter"/>
            <field name="arch" type="xml">
                <xpath expr="//filter[@name='my_sale_orders_filter']" position="replace">
                    <field name="campaign_id"/>
                    <separator/>
                    <filter string="My Quotations" name="my_quotation" domain="[('user_id', '=', uid)]"/>
                    <separator/>
                    <filter string="Clinic" name="is_clinic" domain="[('is_clinic', '=', True)]"/>
                    <separator/>
                    <filter string="Quotations" name="draft" domain="[('state','in',('draft', 'sent'))]"/>
                    <filter string="Sales Orders" name="sales" domain="[('state','in',('sale','done'))]"/>
                    <separator/>
                    <filter string="Create Date" name="filter_create_date" date="create_date"/>
                </xpath>
            </field>
        </record>

        <record id="sale_order_search_view_form" model="ir.ui.view">
            <field name="name">sale.order.search.form</field>
            <field name="model">sale.order</field>
            <field name="mode">primary</field>
            <field name="inherit_id" ref="sale.view_sales_order_filter"/>
            <field name="arch" type="xml">
                <xpath expr="//filter[@name='my_sale_orders_filter']" position="after">
                    <separator/>
                    <filter string="Clinic" name="is_clinic" domain="[('is_clinic', '=', True)]"/>
                    <separator/>
                    <filter string="To Invoice" name="to_invoice" domain="[('invoice_status','=','to invoice')]" />
                    <filter string="To Upsell" name="upselling" domain="[('invoice_status','=','upselling')]" />
                    <separator/>
                    <filter string="Order Date" name="order_date" date="date_order"/>
                </xpath>
            </field>
        </record>

        <record id="sale_order_view_form" model="ir.ui.view">
            <field name="name">sale.order.form</field>
            <field name="model">sale.order</field>
            <field name="inherit_id" ref="sale.view_order_form"/>
            <field name="arch" type="xml">
                <field name="currency_id" position="after">
                    <field name="type_id" required="1" />
                </field>
                <xpath expr="//button[@name='action_view_invoice']" position="after">
                    <button name="helpdesk_ticket" type="object" class="oe_stat_button" icon="fa-ticket">
                        <field name="helpdesk_tickets_count" widget="statinfo" string="Tickets"/>
                    </button>
                </xpath>
                <field name="partner_id" position="after">
                    <field name="is_joint_venture" invisible="1"/>
                    <field name="clinic_id" required="1"/>
                </field>
                <xpath expr="//field[@name='partner_shipping_id']" position="after">
                    <field name="is_clinic" invisible="1"/>
                </xpath>
                <xpath expr="//field[@name='payment_term_id']" position="after">
                    <field name="pricelist_id" string="Price List"/>
                    <field name="tax_id" widget="many2many_tags" attrs="{'invisible': [('is_clinic','!=', True)]}" />
                    <field name="order_start" required="1"/>
                    <field name="order_end"/>
                </xpath>
                <xpath expr="//field[@name='order_line']" position="before">
                    <button class="oe_highlight" groups="podiatry.group_product_configurator" name="action_config_start" states="draft,sent" string="Configure Product" style="margin-top: 15px;" type="object" />
                </xpath>
                <xpath expr="//field[@name='order_line']/form//field[@name='product_id']" position="after">
                    <field invisible="1" name="config_ok" />
                    <field name="config_session_id" />
                </xpath>
                <xpath expr="//field[@name='order_line']/tree//field[@name='product_id']" position="after">
                    <field invisible="1" name="config_ok" />
                    <button attrs="{'invisible': ['|', ('config_ok','=',False), ('state','not in',['draft','sent'])]}" class="fa-lg" groups="podiatry.group_podiatry_configurator" help="Reconfigure" icon="fa-cogs" name="reconfigure_product" type="object" title="Reconfigure" />
                    <field name="config_session_id" />
                </xpath>
                <xpath expr="//field[@name='order_line']/tree/field[@name='name']" position="after">
                    <field name="helpdesk_description_id"/>
                </xpath>
                <xpath expr="//page[@name='other_information']" position="after">
                    <page name='helpdesk_ticket' string='Helpdesk Tickets'>
                        <field name='helpdesk_tickets_ids' context="{'form_view_ref': 'helpdesk.helpdesk_ticket_action_main_tree'}"/>
                    </page>
                </xpath>

            </field>
        </record>





        <record id="sale_order_action" model="ir.actions.act_window">
            <field name="name">Sale Order</field>
            <field name="res_model">sale.order</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('is_joint_venture', '=', 1)]</field>
            <field name="context">{'default_is_joint_venture': 1}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                        Click to book in order
                </p>
                <p>Order Booking</p>
            </field>
        </record>

    </data>

</odoo>