<odoo>
    <data>

        <record id="my_embroidery_tree_view" model="ir.ui.view">
            <field name="name">embroidery.embroidery.tree</field>
            <field name="model">embroidery.embroidery</field>
            <field name="arch" type="xml">
                <tree string="">
                    <field name="name"/>
                    <field name="partner_id"/>
                    <field name="product_tmpl_id"/>
                    <field name="bom_id"/>

                    <!--                    <field name="name" />-->
                    <field name="product_qty"/>
                    <field name="date_planned"/>
                    <field name="state"/>
                    <field name="company_id"/>
                </tree>
            </field>
        </record>

        <record id="my_embroidery_form_view" model="ir.ui.view">
            <field name="name">embroidery.embroidery.form</field>
            <field name="model">embroidery.embroidery</field>
            <field name="arch" type="xml">
                <form string="">
                    <header>

                        <!-- Fabric quality draft stage button-->
                    <!--     <button name="action_check_availability" string="CHECK AVAILABILITY" type="object"        class="oe_highlight" 
                                attrs="{'invisible': ['|', ('state','not in',('draft'))]}"
                               /> -->
                        <button name="action_thread_store"
                                attrs="{'invisible': ['|', ('state','not in',('draft'))]}"
                                string="THREAD STORE" type="object" class="oe_highlight"/>
                        <button name="action_to_cancel"
                                attrs="{'invisible': ['|', ('state','not in',('draft'))]}"
                                string="CANCEL" type="object"/>


                        <!-- Thread Store stage button-->
                        <button name="action_emb_production"
                                attrs="{'invisible': ['|', ('state','not in',('thread_store'))]}"
                                string="PRODUCTION" type="object" class="oe_highlight"/>
                        <button name="action_back_draft"
                                attrs="{'invisible': ['|', ('state','not in',('thread_store'))]}"
                                string="SET TO FABRIC QUALITY" type="object"/>


                        <!-- emb Production stage button-->
                        <button name="action_hand_work"
                                attrs="{'invisible': ['|', ('state','not in',('emb_production'))]}"
                                string="HANDWORK" type="object" class="oe_highlight"/>
                        <button name="action_back_thread_store"
                                attrs="{'invisible': ['|', ('state','not in',('emb_production'))]}"
                                string="SET TO THREAD STORE" type="object"/>
                        <!-- back button-->


                        <!-- emb clipping stage button-->
                        <button name="action_emb_finishing"
                                attrs="{'invisible': ['|', ('state','not in',('hand_work'))]}"
                                string="EMB FINISHING" type="object" class="oe_highlight"/>
                        <!-- back button-->
                        <button name="action_back_production"
                                attrs="{'invisible': ['|', ('state','not in',('hand_work'))]}"
                                string="SET TO EMB PRODUCTION" type="object"/>


                        <!-- emb finishing stage button-->
                        <button name="action_internal_audit"
                                attrs="{'invisible': ['|', ('state','not in',('emb_finishing'))]}"
                                string="INTERNAL AUDIT" type="object" class="oe_highlight"/>
                        <!-- back button-->
                        <button name="action_back_hand_work"
                                attrs="{'invisible': ['|', ('state','not in',('emb_finishing'))]}"
                                string="SET TO HANDWORK" type="object"/>


                        <!-- internal audit stage-->
                        <button name="action_external_audit"
                                attrs="{'invisible': ['|', ('state','not in',('internal_audit')),('external_layout', '=', False)]}"
                                string="EXTERNAL AUDIT" type="object" class="oe_highlight"/>
                        <!-- this  button show if flow is 2-->
                        <button name="action_emb_dispatch"
                                attrs="{'invisible': ['|', ('state','not in',('internal_audit')),('dispatch_button', '=', False)]}"
                                string="DISPATCH" type="object" class="oe_highlight"/>
                        <!-- back button to finishing-->
                        <button name="action_back_finishing"
                                attrs="{'invisible': ['|', ('state','not in',('internal_audit'))]}"
                                string="SET TO FINISHING" type="object"/>


                        <!-- external audit stage button-->
                        <button name="action_emb_dispatch"
                                attrs="{'invisible': ['|', ('state','not in',('external_audit'))]}"
                                string="DISPATCH" type="object" class="oe_highlight"/>
                        <button name="action_back_internal_audit"
                                attrs="{'invisible': ['|', ('state','not in',('external_audit'))]}"
                                string="SET TO INTERNAL AUDIT" type="object"/>


                        <!-- dispatch stage button-->
                        <button name="action_confirm"
                                attrs="{'invisible': ['|', ('state','not in',('dispatch'))]}"
                                string="CONFIRM" type="object" class="oe_highlight"/>
                        <!-- this  button show if flow is 2 and direct back to internal audit-->
                        <button name="action_back_internal_audit"
                                attrs="{'invisible': ['|', ('state','not in',('dispatch')),('back_internal_layout', '=', False)]}"
                                string="SET TO INTERNAL AUDIT" type="object"/>

                        <button name="action_back_external_audit"
                                attrs="{'invisible': ['|', ('state','not in',('dispatch')),('back_internal_layout', '=', True)]}"
                                string="SET TO EXTERNAL AUDIT" type="object"/>


                        <!-- confirm stage button-->
                        <button name="action_back_dispatch"
                                attrs="{'invisible': ['|', ('state','not in',('confirmed'))]}"
                                string="SET TO DISPATCH" type="object"/>

                        <field name="state" widget="statusbar"
                               statusbar_visible="draft,emb_production,thread_store,hand_work,emb_finishing,internal_audit,external_audit,dispatch,confirmed"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="toggle_active"
                                    class="oe_stat_button" icon="fa-archive" radonly="True">
                                <field name="draft_stage" attrs="{'invisible': ['|', ('state', '!=', 'draft')]}"/>
                                <field name="thread_stage"
                                       attrs="{'invisible': ['|', ('state', '!=', 'thread_store')]}"/>
                                <field name="production_stage"
                                       attrs="{'invisible': ['|', ('state', '!=', 'emb_production')]}"/>
                                <field name="clipping_stage"
                                       attrs="{'invisible': ['|', ('state', '!=', 'hand_work')]}"/>
                                <field name="finishing_stage"
                                       attrs="{'invisible': ['|', ('state', '!=', 'emb_finishing')]}"/>
                                <field name="internal_audit"
                                       attrs="{'invisible': ['|', ('state', '!=', 'internal_audit')]}"/>
                                <field name="external_audit"
                                       attrs="{'invisible': ['|', ('state', '!=', 'external_audit')]}"/>
                                <field name="dispatch_stage" attrs="{'invisible': ['|', ('state', '!=', 'dispatch')]}"/>
                                <field name="confirmed_stage"
                                       attrs="{'invisible': ['|', ('state', '!=', 'confirmed')]}"/>
                            </button>
                        </div>
                        <div class="oe_title">
                            <h1>
                                <field name="name"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="partner_id" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="bom_id"
                                       context="{'default_product_tmpl_id': product_tmpl_id}" required="1"
                                       attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="product_tmpl_id" force_save="1"/>

                                <!--                                <field name="test_001" force_save="1"/>-->

                                <field name="name" invisible="1"/>

                                <!--                                <field name="brand_id" invisible="0"/>-->
                                <!--                                <field name="batch_no" string="Batch Number" invisible="0"/>-->
                                <!--                                <field name="taxes_id" invisible="0"/>-->

                                <field name="product_qty" class="mr-1"
                                       attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="total_head" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="fabric_height" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="design_height" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="designed_head" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="stitched" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="total_fabric" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="total_stitches" attrs="{'readonly': [('state', '!=', 'draft')]}"/>

                            </group>

                            <group>
                                <field name="date_planned" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="date_deadline" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="user_id" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="company_id" invisible="1"/>
                                <field name="machine" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="flow" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="flow_one_string" attrs="{'invisible': [('flow', '!=', 'flow_one')]}"/>
                                <field name="flow_two_string" attrs="{'invisible': [('flow', '!=', 'flow_two')]}"/>
                                <field name="production_stitches" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                                <field name="internal_layout" invisible="1"/>
                                <field name="external_layout" invisible="1"/>
                                <field name="dispatch_button" invisible="1"/>
                                <field name="back_internal_layout" invisible="1"/>
                                <field name="entry" invisible="1"/>
                                <field name="production_qty_update" invisible="1"/>
                                <field name="components_qty_update" invisible="1"/>

                                <seperator/>
                                <field name="avg_prod_stch" invisible="0"/>
                                <field name="days_plan" invisible="0"/>

                            </group>
                            <!-- buttons part  -->
                            <group>
                                <group>
                                    <button name="thread_store_update_action"
                                            attrs="{'invisible': ['|', ('state','not in',('thread_store'))]}"
                                            string="UPDATE" type="object" class="oe_highlight"/>
                                    <button name="production_update_action"
                                            attrs="{'invisible': ['|', ('state','not in',('emb_production'))]}"
                                            string="UPDATE" type="object" class="oe_highlight"/>
                                    <button name="handwork_update_action"
                                            attrs="{'invisible': ['|', ('state','not in',('hand_work'))]}"
                                            string="UPDATE" type="object" class="oe_highlight"/>
                                    <button name="finishing_update_action"
                                            attrs="{'invisible': ['|', ('state','not in',('emb_finishing'))]}"
                                            string="UPDATE" type="object" class="oe_highlight"/>
                                    <button name="int_audit_update_action"
                                            attrs="{'invisible': ['|', ('state','not in',('internal_audit'))]}"
                                            string="UPDATE" type="object" class="oe_highlight"/>
                                    <button name="ext_audit_update_action"
                                            attrs="{'invisible': ['|', ('state','not in',('external_audit'))]}"
                                            string="UPDATE" type="object" class="oe_highlight"/>
                                    <button name="dispatch_update_action"
                                            attrs="{'invisible': ['|', ('state','not in',('dispatch'))]}"
                                            string="UPDATE" type="object" class="oe_highlight"/>
                                </group>
                            </group>
                            <!--end button part -->
                        </group>
                        <!-- employee line for thread store state -->
                        <field name="thread_employee_ids" attrs="{'invisible': [('state', '!=', 'thread_store')]}">
                            <tree string="PRODUCTION" editable="bottom">
                                <field name="employee_id"/>
                                <field name="rate"/>
                                <field name="line_readonly" invisible="1"/>
                                <field name="shift"/>
                                <field name="reject_repeats"/>
                                <field name="reject_stitches"/>
                                <field name="closed_repeats"/>
                                <field name="closed_stitches"/>
                                <field name="company_id" invisible="1"/>
                                <field name="check_new" invisible="1"/>

                            </tree>
                        </field>
                        <!-- employee line for production state -->
                        <field name="production_employee_ids"
                               attrs="{'invisible': [('state', '!=', 'emb_production')]}">
                            <tree string="PRODUCTION" editable="bottom">
                                <field name="employee_id"/>
                                <field name="rate"/>
                                <field name="line_readonly" invisible="1"/>
                                <field name="shift"/>
                                <field name="reject_repeats"/>
                                <field name="reject_stitches"/>
                                <field name="closed_repeats"/>
                                <field name="closed_stitches"/>
                                <field name="company_id" invisible="1"/>

                            </tree>
                        </field>
                        <!-- employee line for hand work state -->
                        <field name="handwork_employee_ids" attrs="{'invisible': [('state', '!=', 'hand_work')]}">
                            <tree string="Handwork" editable="bottom">
                                <field name="employee_id"/>
                                <field name="rate"/>
                                <field name="line_readonly" invisible="1"/>
                                <field name="shift"/>
                                <field name="reject_repeats"/>
                                <field name="reject_stitches"/>
                                <field name="closed_repeats"/>
                                <field name="closed_stitches"/>
                                <field name="company_id" invisible="1"/>
                            </tree>
                        </field>

                        <!-- employee line for finishing state -->
                        <field name="finishing_employee_ids" attrs="{'invisible': [('state', '!=', 'emb_finishing')]}">
                            <tree string="FINISHING" editable="bottom">
                                <field name="employee_id"/>
                                <field name="rate"/>
                                <field name="line_readonly" invisible="1"/>
                                <field name="shift"/>
                                <field name="reject_repeats"/>
                                <field name="reject_stitches"/>
                                <field name="closed_repeats"/>
                                <field name="closed_stitches"/>
                                <field name="company_id" invisible="1"/>
                            </tree>
                        </field>
                        <!-- employee line for audit state -->
                        <field name="audit_employee_ids" attrs="{'invisible': [('state', '!=', 'internal_audit')]}">
                            <tree string="AUDIT" editable="bottom">
                                <field name="employee_id"/>
                                <field name="rate"/>
                                <field name="line_readonly" invisible="1"/>
                                <field name="shift"/>
                                <field name="reject_repeats"/>
                                <field name="reject_stitches"/>
                                <field name="closed_repeats"/>
                                <field name="closed_stitches"/>
                                <field name="company_id" invisible="1"/>
                            </tree>
                        </field>

                        <!-- employee line for external audit state -->
                        <field name="ex_audit_employee_ids" attrs="{'invisible': [('state', '!=', 'external_audit')]}">
                            <tree string="External AUDIT" editable="bottom">
                                <field name="employee_id"/>
                                <field name="rate"/>
                                <field name="line_readonly" invisible="1"/>
                                <field name="shift"/>
                                <field name="reject_repeats"/>
                                <field name="reject_stitches"/>
                                <field name="closed_repeats"/>
                                <field name="closed_stitches"/>
                                <field name="company_id" invisible="1"/>
                            </tree>
                        </field>

                        <!-- Dispatch employee line for external -->
                        <field name="disp_audit_employee_ids" attrs="{'invisible': [('state', '!=', 'dispatch')]}">
                            <tree string="Dispatch" editable="bottom">
                                <field name="employee_id"/>
                                <field name="rate"/>
                                <field name="line_readonly" invisible="1"/>
                                <field name="shift"/>
                                <field name="reject_repeats"/>
                                <field name="reject_stitches"/>
                                <field name="closed_repeats"/>
                                <field name="closed_stitches"/>
                                <field name="company_id" invisible="1"/>
                            </tree>
                        </field>
                        <!-- employee line for dispatch state -->
                        <!--                        <field name="dispatch_employee_ids" attrs="{'invisible': [('state', '!=', 'confirmed')]}">-->
                        <!--                            <tree string="DISPATCH" editable="bottom">-->
                        <!--                                <field name="employee_id"/>-->
                        <!--                                <field name="rate"/>-->
                        <!--                                <field name="shift"/>-->
                        <!--                                <field name="closed_repeats"/>-->
                        <!--                                <field name="closed_stitches"/>-->
                        <!--                                <field name="reject_repeats"/>-->
                        <!--                                <field name="reject_stitches"/>-->
                        <!--                                <field name="work_done"/>-->
                        <!--                                <field name="company_id" invisible="1"/>-->
                        <!--                            </tree>-->
                        <!--                        </field>-->

                        <notebook>
                            <page string="COMPONENTS" attrs="{'invisible': [('state', '!=', 'draft')]}">
                                <field name="embroidery_line_ids">
                                    <tree string="COMPONENTS" editable="bottom">
                                        <field name="company_id" invisible="1"/>
                                        <field name="product_id" context="{'default_type': 'product'}"/>
                                        <field name="stitches"/>
                                        <field name="attach"/>
                                        <field name="total_stitches" force_save="1"/>
                                        <field name="total_yard" force_save="1"/>
                                        <field name="total_cones" force_save="1"/>
                                        <field name="available_stock" force_save="1" invisible="1"/>
                                        <field name="net_cones" force_save="1" invisible="1"/>
                                        <field name="lot_size" force_save="1" invisible="1"/>
                                        <field name="factor" force_save="1" invisible="1"/>
                                        <field name="real_factor" force_save="1" invisible="1"/>
                                        <field name="net_ordering" force_save="1" invisible="1"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="FABRIC" attrs="{'invisible': [('state', '!=', 'draft')]}">
                                <field name="fabric_quality_line_ids">
                                    <tree string="FABRIC" editable="bottom">
                                        <field name="total_fabric"/>
                                        <field name="a_grade_fabric"/>
                                        <field name="b_grade_fabric"/>
                                        <field name="reject_fabric"/>
                                        <field name="balance_fabric"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="PRODUCTION RESULT" attrs="{'invisible': [('state', 'in', 'draft')]}">
                                <field name="result_embroidery_line_ids">
                                    <tree string="RESULT" editable="bottom">
                                        <field name="company_id" invisible="1"/>
                                        <field name="total_repeats"/>
                                        <field name="total_stitches"/>
                                        <field name="closed_repeats"/>
                                        <field name="closed_stitches"/>
                                        <field name="pending_repeats"/>
                                        <field name="pending_stitches"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="action_embroidery_view" model="ir.actions.act_window">
            <field name="name">Embroidery</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">embroidery.embroidery</field>
            <field name="view_mode">tree,form</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    <!-- Add Text Here -->
                </p>
                <p>
                    <!-- More details about what a user can do with this object will be OK -->
                </p>
            </field>
        </record>


        <menuitem id="menu_embroidery_view"
                  name="Manufacturing Orders"
                  parent="menu_embroidery_operations"
                  action="action_embroidery_view"
                  sequence="1"/>


    </data>
</odoo>